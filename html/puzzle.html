<html>
        <head>
                <script type="text/javascript"
                                            src="http://code.jquery.com/jquery-1.7.2.min.js"></script>
                 <script type="text/javascript">
                         var user = undefined;
                         var message = undefined;
                         var ignored = {gid:"g1",
                                 uid:"u0",
                                 pid:3,
                                 previous:2,
                                 scramble:"ijklmop"};
                         LOCAL
                        (function activity() {
                                $.getJSON('/game/' + local.gid)
                                .done(function(data) {
                                        console.log('activity data = ' + data);
                                     html = '<ul>';
                                     for (i = 0; i < data.users.length; i++) {
                                        html += '<li>';
                                        html += 'User "' + data.users[i].name + '" ';
                                        html += 'Puzzle "' + data.users[i].puzzle + '"';
                                        html += '</li>';
                                     }
                                     html += '</ul>';
                                     html += 'Time = ' + data.timer;
                                     document.getElementById('activity').innerHTML = "<p>" + html + "</p>";
                                     setTimeout(activity, 1000);
                                        })
                                .fail(function() {
                                     document.getElementById('activity').innerHTML = "<p>Error</p>";
                                        })
                                .always(function() {
                                        }) ;
                                })();


                        // reload puzzle state
                        (function puzzle() {
                                $.getJSON('/game/' + local.gid + '/puzzle/' + local.pid)
                                .done(function(data) {
                                     document.getElementById('scramble').innerHTML = data.scramble;
                                     if (data.state) {
                                        document.getElementById('puzzle.state').innerHTML = data.state;
                                     }
                                     setTimeout(puzzle, 1000);
                                        })
                                .fail(function() {
                                     document.getElementById('scramble').innerHTML = "<font color=red>Error Loading Puzzle</font>";
                                        })
                                .always(function() {
                                        }) ;
                                })();

                        function writePuzzleLink(pid, linkText) {
                                document.write('<a href="/puzzle/' + pid +
                                                '?u=' + local.uid +
                                                '&g=' + local.gid +
                                                '">');
                                document.write(linkText);
                                document.write('</a>');
                        }
                </script>

        </head>
        <body>
                <h1>
                Puzzle <script type="text/javascript">
                        document.write(local.pid)
        if (local.state) {
                document.write('(' + local.state + ')')
        }
                </script>
                <div id='puzzle.state'></div>
                </h1>
                <script type="text/javascript">
if (message !== undefined) {
        document.write('<p><font color="red"><i>' + message + '</i></font></p>');
}
</script>
                <!-- activity -->
                <div class="activity" id="activity"
                        style="border:1px solid black;">
                        Loading...
                </div>

                <!-- previous puzzle -->
                <div style="float:left">
                <script type="text/javascript">
                        if (local.previous != null) {
                            writePuzzleLink(local.previous, "Previous Puzzle");
                        }
                </script>
                </div>

                <!-- scramble -->
                <div class="puzzle" style="float:center">
                        <div class="scramble">
                                <p><b>Scramble = &quot;
                                        <div id="scramble">
                                                ...
                                        </div>
                        &quot;
                </b></p>
                </div>

                <!-- guess -->
                <script type="text/javascript">
                        // TODO: fix this check
                        if (local.state != "solved") {
                document.write('<form action="/game/' + local.gid + '/puzzle/' + local.pid + '" method="post">');
                        document.write('<input type="text" name="l1" maxlength=1 size=1>');
                        document.write('<input type="text" name="l2" maxlength=1 size=1>');
                        document.write('<input type="text" name="l3" maxlength=1 size=1>');
                        document.write('<input type="text" name="l4" maxlength=1 size=1>');
                        document.write('<input type="text" name="l5" maxlength=1 size=1>');
                        document.write('<input type="text" name="l6" maxlength=1 size=1>');
                        document.write('<input type="text" name="l7" maxlength=1 size=1 value="">');
                                document.write('<input type="hidden" name="uid" value="' + local.uid + '">')
                        document.write('<br>');
                        document.write('<input type="submit" value="Submit Guess">');
                document.write('</form>');
                        }
                </script>
                </div>

                <!-- next puzzle -->
                <div style="float:right">
                <script type="text/javascript">
                        if (local.next != null) {
                            writePuzzleLink(local.next, "Next Puzzle");
                        }
                </script>
                </div>

        </body>
</html>
